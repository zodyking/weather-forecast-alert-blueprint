<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Weather — Forecast TTS (AI Optional) · Documentation</title>
<meta name="description" content="Documentation for the Weather — Forecast TTS (AI Optional) Home Assistant blueprint." />
<style>
  :root{
    --bg:#0b0e14; --panel:#0f1421; --card:#0f1629; --text:#e6edf3; --muted:#9aa4b2;
    --brand:#60a5fa; --brand2:#22c55e; --border:#1f2940; --code:#0b1220; --warn:#f59e0b; --err:#ef4444;
    --r:16px; --shadow:0 10px 30px rgba(0,0,0,.35)
  }
  @media (prefers-color-scheme:light){
    :root{ --bg:#f6f8fb; --panel:#ffffff; --card:#ffffff; --text:#0b1220; --muted:#5b6573;
           --brand:#2563eb; --brand2:#10b981; --border:#dfe6ef; --code:#0f172a; --shadow:0 12px 28px rgba(16,24,40,.12)}
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif}
  a{color:var(--brand);text-decoration:none}
  header.hero{border-bottom:1px solid var(--border);
    background:radial-gradient(900px 400px at 8% -10%, rgba(96,165,250,.25), transparent 60%),
               radial-gradient(800px 500px at 110% 0%, rgba(34,197,94,.18), transparent 60%),
               linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));}
  .wrap{max-width:1200px;margin:0 auto;padding:24px}
  .hero-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;align-items:center;padding:40px 24px}
  .hero h1{margin:0 0 10px 0;font-size:40px}
  .hero p{margin:0 0 14px 0;color:var(--muted)}
  .badge{display:inline-block;padding:4px 10px;border:1px solid rgba(96,165,250,.45);color:var(--brand);border-radius:999px;font-size:12px;background:rgba(96,165,250,.12);margin-bottom:8px}
  .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .btn{display:inline-flex;gap:8px;align-items:center;padding:12px 14px;border-radius:12px;border:1px solid var(--brand);background:var(--brand);color:#fff;font-weight:600;box-shadow:var(--shadow)}
  .btn.secondary{background:transparent;color:var(--brand)}
  .banner{width:100%;border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow)}
  main.layout{display:grid;grid-template-columns:300px 1fr;gap:22px;margin-top:24px}
  @media (max-width:1050px){ main.layout{grid-template-columns:1fr} }
  nav.side{position:sticky;top:16px;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px;height:max-content}
  nav h3{margin:6px 0 10px;font-size:16px}
  details.group{border:1px solid var(--border);border-radius:10px;background:transparent;margin:8px 0}
  details.group>summary{cursor:pointer;padding:10px 12px;font-weight:700}
  .links{padding:6px 12px 12px}
  .links a{display:block;padding:6px 0;color:var(--muted);font-size:14px}
  section.card{background:var(--card);border:1px solid var(--border);border-radius:var(--r);box-shadow:var(--shadow);padding:18px}
  h2{margin:4px 0 12px;font-size:26px} h3{margin:18px 0 8px;font-size:20px}
  .grid{display:grid;gap:16px} .cols-2{grid-template-columns:1fr} @media (min-width:900px){.cols-2{grid-template-columns:1fr 1fr}}
  .call{border-left:4px solid var(--brand);background:rgba(96,165,250,.08);padding:12px;border-radius:10px}
  .call.warn{border-left-color:var(--warn);background:rgba(245,158,11,.12)}
  .table{width:100%;border-collapse:separate;border-spacing:0 8px}
  .row{background:var(--panel);border:1px solid var(--border);border-radius:10px}
  .table th,.table td{padding:10px 12px;vertical-align:top} .table th{color:#9aa4b2;text-align:left}
  pre{background:var(--code);color:#c9e3ff;border:1px solid #102342;border-radius:12px;padding:14px;overflow:auto}
  code{font-family:ui-monospace,Menlo,Consolas,monospace}
  footer{color:#9aa4b2;text-align:center;padding:26px}
  .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--panel);color:#9aa4b2;margin-right:6px}
</style>
</head>
<body>

<header class="hero">
  <div class="wrap hero-grid">
    <div>
      <span class="badge">Home Assistant Blueprint</span>
      <h1>Weather — Forecast TTS <span style="color:#9aa4b2">(AI Optional)</span></h1>
      <p>TV-style forecasts on your speakers by schedule, sensor, webhook, or voice. Uses daily + hourly data, calls out first likely precip window with time and %, optional AI rephrase without changing facts.</p>
      <div class="btns">
        <a class="btn" href="homeassistant://blueprint/import?url=https://raw.githubusercontent.com/zodyking/weather-forecast-alert-blueprint/refs/heads/main/weather-forecast.yaml">Import to Home Assistant</a>
        <a class="btn secondary" target="_blank" rel="noopener" href="https://raw.githubusercontent.com/zodyking/weather-forecast-alert-blueprint/refs/heads/main/weather-forecast.yaml">Raw YAML</a>
        <a class="btn secondary" target="_blank" rel="noopener" href="https://github.com/zodyking/weather-forecast-alert-blueprint">Repository</a>
      </div>
      <div style="margin-top:12px">
        <span class="pill">Schedule / Sensor / Webhook / Voice</span>
        <span class="pill">Per-scenario volume + pre-roll</span>
        <span class="pill">Optional AI rephrase</span>
      </div>
    </div>
    <div>
      <img class="banner" alt="Blueprint banner"
        src="https://raw.githubusercontent.com/zodyking/weather-forecast-alert-blueprint/refs/heads/main/imageforecast.png">
    </div>
  </div>
</header>

<div class="wrap">
  <main class="layout">
    <nav class="side" aria-label="Documentation">
      <h3>Guide</h3>
      <details class="group" open>
        <summary>Getting started</summary>
        <div class="links">
          <a href="#overview">Overview</a>
          <a href="#requirements">Requirements</a>
          <a href="#webhook">Webhook URL</a>
          <a href="#folders">Repo layout</a>
        </div>
      </details>
      <details class="group" open>
        <summary>Configuration</summary>
        <div class="links">
          <a href="#inputs">Inputs overview</a>
        </div>
      </details>
      <details class="group" open>
        <summary>Automation Mock</summary>
        <div class="links">
          <a href="#mock">Triggers</a>
          <a href="#mock">Conditions</a>
          <a href="#mock">Actions</a>
          <a href="#mock">Variables</a>
        </div>
      </details>
    </nav>

    <div>
      <section id="overview" class="card">
        <h2>Overview</h2>
        <div class="grid cols-2">
          <div class="call">Fetches daily and hourly forecasts, crafts a concise forecast, optional AI rephrase that preserves facts, then speaks on selected speakers with a pre-roll delay.</div>
          <div class="call warn">Precipitation callouts require hourly <code>precipitation_probability</code>. If missing, the precip line is skipped.</div>
        </div>
      </section>

      <section id="requirements" class="card">
        <h2>Requirements</h2>
        <ul>
          <li><code>weather</code> entity supporting <code>weather.get_forecasts</code> for daily + hourly.</li>
          <li><code>tts</code> engine and at least one <code>media_player</code>.</li>
          <li>Optional: AI Task entity; Conversation integration for voice.</li>
        </ul>
      </section>

      <section id="webhook" class="card">
        <h2>Webhook URL</h2>
        <p>Local canonical URL using the blueprint input:</p>
        <pre><code>http://homeassistant.local:8123/api/webhook/&lt;WEBHOOK_ID_FROM_INPUT&gt;</code></pre>
      </section>

      <section id="inputs" class="card">
        <h2>Inputs overview</h2>
        <table class="table">
          <tr><th>Group</th><th>Key(s)</th><th>Description</th></tr>
          <tr class="row"><td>Weather</td><td><code>weather_entity</code></td><td>Source of current, daily, hourly.</td></tr>
          <tr class="row"><td>TTS</td><td><code>tts_engine</code>, <code>speakers</code>, <code>voice</code>, <code>volume_level</code>, <code>preroll_ms</code></td><td>Engine, targets, voice, volume, wake-up delay.</td></tr>
          <tr class="row"><td>AI</td><td><code>ai_task_entity</code>, <code>use_ai_rewrite</code>, <code>ai_rewrite_prompt</code></td><td>Optional AI pass with strict no-fact-change rules.</td></tr>
          <tr class="row"><td>Time</td><td><code>enable_time_based</code>, <code>hour_pattern</code>, <code>minute_offset</code>, <code>start_time</code>, <code>end_time</code>, <code>days_of_week</code></td><td>Schedule and windowing.</td></tr>
          <tr class="row"><td>Sensor</td><td><code>enable_sensor_triggered</code>, <code>presence_sensors</code></td><td>Announce when sensors turn <code>on</code>.</td></tr>
          <tr class="row"><td>Webhook</td><td><code>enable_alarm_announce</code>, <code>webhook_id</code>, <code>personal_name</code>, <code>alarm_volume_level</code></td><td>On-demand personal report.</td></tr>
          <tr class="row"><td>Change</td><td><code>enable_current_change_announce</code>, <code>current_change_volume_level</code>, <code>enable_upcoming_change_announce</code>, <code>upcoming_change_volume_level</code>, <code>minutes_before_announce</code></td><td>Real-time and impending precip alerts.</td></tr>
          <tr class="row"><td>Precip</td><td><code>precip_threshold</code>, <code>hours_ahead</code></td><td>Threshold and search window.</td></tr>
          <tr class="row"><td>Voice</td><td><code>enable_voice_satellite</code>, <code>conversation_command</code></td><td>Conversation trigger phrases.</td></tr>
        </table>
      </section>

      <!-- ======= AUTOGENERATED MOCK START ======= -->
      <section id="mock" class="card">
        <h2>Automation Mock (mirrors <code>weather-forecast.yaml</code>)</h2>
        <!-- BEGIN:AUTOGEN_MOCK -->
        <!-- Generated by tools/render_mock.py. Do not edit between markers. -->
        <!-- END:AUTOGEN_MOCK -->
        <p style="color:#9aa4b2;margin-top:10px">This section is pure HTML, updated by CI on each push to the YAML.</p>
      </section>
      <!-- ======= AUTOGENERATED MOCK END ======= -->

      <section id="folders" class="card">
        <h2>Repo layout</h2>
        <ul>
          <li><strong>/weather-forecast.yaml</strong> — Production blueprint</li>
          <li><strong>/backup/</strong> — Snapshots</li>
          <li><strong>/development/</strong> — Drafts</li>
          <li><strong>/docs/index.html</strong> — This page</li>
          <li><strong>/tools/render_mock.py</strong> — Generator for the mock</li>
        </ul>
      </section>

      <footer>© Weather — Forecast TTS (AI Optional). This page is pure HTML. The mock is regenerated on push.</footer>
    </div>
  </main>
</div>

</body>
</html>
